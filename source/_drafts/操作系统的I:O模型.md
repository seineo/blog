操作系统有两个主要工作，一个是计算，另一个就是I/O。本文从内核态到用户态，自底至上地介绍操作系统的I/O模型。

## 整体架构



## 内核态视角

I/O设备各式各样，但是作为操作系统，我们会希望有统一的接口来管理它们，这些接口称为**设备驱动**。当然不会有一个接口适配于所有设备，存储设备、传输设备、人机交互设备等等都有各自类别的设备驱动。

i/o硬件：port、bus、controller

设备控制器不属于操作系统范畴，它是属于硬件，而设备驱动程序属于操作系统的一部分，操作系统的内核代码可以像本地调用代码一样使用设备驱动程序的接口，而设备驱动程序是面向设备控制器的代码，它发出操控设备控制器的指令后，才可以操作设备控制器。

I/O操作从不同维度有不同的分类：

-   







通过device driver的统一接口与不同的I/O子系统交互。



port I/O：适合小数据量，写到I/O寄存器里，不占用内存空间。

memory I/O：适合大数据量，写到指定物理地址，占用了内存空间。



DMA：

<img src="https://oss.seineo.cn/images/202407070044020.png" alt="截屏2024-07-07 00.43.56" style="zoom: 50%;" />

### 零拷贝技术



## 用户态视角

程序员一般是同步思维，

read/write

select/poll/epoll/kqueue 不过一般用于网络i/o。



5中I/O模型

## 参考

-   无意间刷到的国立清华教授课程，讲得很清晰：https://ocw.nthu.edu.tw/ocw/index.php?page=chapter&cid=141&chid=3025